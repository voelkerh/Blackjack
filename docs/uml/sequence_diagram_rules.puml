@startuml
title API Endpoint /api/blackjack/rules
actor Player

participant "Controller\n(Rest Adapter)" as Controller
participant "RulesService\n(Use Case)" as Service
participant "FileRulesAdapter\n(Outbound Port)" as Adapter
database PostgresSQL

== Request General Rules ==

    Player --> Controller : GET /api/blackjack/rules
    Controller --> Service : emitRules(query)
    Service --> Adapter : retrieveRules(GENERAL)
    Adapter --> PostgresSQL : SQL Query

alt resource found

    PostgresSQL --> Adapter : Rules
    Adapter --> Service : Rules
    Service --> Controller : Result
    Controller --> Player : 200 OK + Response

else resource not found
    PostgresSQL --> Adapter : not found
    Adapter --> Service : error
    Service --> Controller : error
    Controller --> Player : 404 Not Found

end

== Request Rules For Specific Action==

Player -> Controller : GET /api/blackjack/rules/{action}
Controller -> Controller : validateRequest()

alt valid request

        Controller -> Service : emitRules(query)
        Service -> Adapter : retrieveRules(HIT/STAND)
        Adapter -> PostgresSQL : SQL Query(state)

    alt resource found
        PostgresSQL --> Adapter : Rules
        Adapter --> Service : Rules
        Service --> Controller : Result
        Controller --> Player : 200 OK + Response

    else resource not found
        PostgresSQL --> Adapter : not found
        Adapter --> Service : error
        Service --> Controller : error
        Controller --> Player : 404 Not Found
    end

else invalid state definition

    Controller --> Player : 400 Bad Request

end

@enduml